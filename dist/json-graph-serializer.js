!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.jsonGraphSerializer=r():e.jsonGraphSerializer=r()}(this,(function(){return(()=>{"use strict";var e={d:(r,n)=>{for(var t in n)e.o(n,t)&&!e.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:n[t]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,r){if(e){if("string"==typeof e)return o(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,r):void 0}}function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function f(e,r){var t=Object.assign({prefix:"~$£€"},r),o=t.prefix,f=t.substitor,l=o+">",u=o+"°",c=o+"þ",s=Symbol(),y=[];try{var p=function(e){return e[s]=1,e},v=0;return JSON.stringify(e,(function(e,r){if(e===l||e===u||e===c){if(null!==r&&r[s])return r;throw new Error("Conflicting serialization prefix: property '"+e+"' exists.")}if(null===r||"object"!==a(r)||r[s])return r;var t,o=r[u];if(o){if(o[s])return i({},l,o);throw new Error("Conflicting serialization prefix: property '"+u+"' exists.")}if(r[u]=(t=v++,o=p(new Number(t))),y.push(r),r instanceof Array)r=p([p(i({},c,p([o,"A"])))].concat(n(r)));else if(r instanceof Map)r=p([p(i({},c,p([o,"M"])))].concat(n(n(r).map((function(e){return p(e)})))));else if(r instanceof Set)r=p([p(i({},c,p([o,"S"])))].concat(n(r)));else if(f){var d=f(r,c);d&&d!==r&&((r=d)[u]=o,r[c]=function(e){if("string"!=typeof e)throw new Error("Type must be a String.");return p(new String(e))}(r[c]||""))}return r}))}finally{y.forEach((function(e){return delete e[u]}))}}function l(e,r){var n=Object.assign({prefix:"~$£€"},r),o=n.prefix,i=n.activator,f=o+">",l=o+"°",u=o+"þ",c=null,s=null,y=[];function p(e,r){var n=null;if(r instanceof Array)if(r.length>0&&null!=r[0]&&void 0!==(n=r[0][u])){switch(r.splice(0,1),n[1]){case"A":break;case"M":r=Object.assign(new Map,{v:r});break;case"S":r=Object.assign(new Set,{v:r});break;default:throw new Error("Expecting typed array to be 'A', 'M' or 'S'.")}y[n[0]]=r}else null===s&&(s=new Set),s.add(r);else if(null!==r){var t=r[l];void 0!==t?(delete r[l],void 0!==(n=r[u])&&(delete r[u],i&&(r=i(r,n))&&(null===c&&(c=new Set),c.add(r))),y[t]=r):(null===s&&(s=new Set),s.add(r))}return r}var v="string"==typeof e?JSON.parse(e,p):p(0,function e(r){if(r)if(r instanceof Array)for(var n=0;n<r.length;++n){var t=r[n];e(t),r[n]=p(0,t)}else if("object"===a(r))for(var o in r){var i=r[o];e(i),r[o]=p(0,i)}return r}(e));function d(e,r){for(var n=r.length,t=0;t<n;++t){var o=r[t];if(o){var i=o[f];void 0!==i&&(r[t]=e[i])}}}for(var b=function(){var e=S[m];if(null===c||!c.has(e))if(e instanceof Array)d(y,e);else if(e instanceof Map)e.v.forEach((function(e){return d(y,e)})),e.v.forEach((function(r){return e.set(r[0],r[1])})),delete e.v;else if(e instanceof Set)d(y,e.v),e.v.forEach((function(r){return e.add(r)})),delete e.v;else for(var r in e){var n=e[r];if(null!==n){var t=n[f];void 0!==t&&(e[r]=y[t])}}},m=0,S=y;m<S.length;m++)b();if(null!==s){var h,g=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=t(e))){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,f=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return f=e.done,e},e:function(e){l=!0,a=e},f:function(){try{f||null==n.return||n.return()}finally{if(l)throw a}}}}(s);try{for(g.s();!(h=g.n()).done;){var w=h.value;if(w instanceof Array)d(y,w);else for(var j in w){var A=w[j];if(null!==A){var x=A[f];void 0!==x&&(w[j]=y[x])}}}}catch(e){g.e(e)}finally{g.f()}}return v}return e.r(r),e.d(r,{serialize:()=>f,deserialize:()=>l}),r})()}));